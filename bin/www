#!/usr/bin/env node
var debug = require('debug')('meanreader');
var app = require('../app');

var server = require('http').Server(app);
server.listen(process.env.PORT || 3000);

var io = require('socket.io')(server);

var Watcher = require('rss-watcher');
var watcher = new Watcher('http://podcasts.engadget.com/rss.xml');

watcher.on('new article', function(article) {
  io.sockets.emit('newMessage', article);
});
//
// watcher.run(function(err, articles) {
//   if (err)
//     console.log(err);
//   console.log(articles);
// });

watcher.on('stop', function() {
  console.log('feed stopped.');
});
